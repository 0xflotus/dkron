---
etcd:
  image: microbox/etcd
  ports:
    - "4001"
  volumes:
    - ./etcd.data:/data
  command: -name=dcron1

# consul:
#   image: progrium/consul
#   ports:
#     - "8500"
#   hostname: node1
#   command: -server -bootstrap -ui-dir=/ui

dkron_seed:
  links:
    # - consul
    - etcd
  ports:
    - "8080"
  build: .
  volumes:
    - ./:/gopath/src/github.com/victorcoder/dkron
  environment:
    - GODEBUG=netdns=go
  command: go run main.go agent -server -backend=etcd -backend-machine=etcd:4001 -join=dkron:8946

dkron:
  links:
    # - consul
    - etcd
    - dkron_seed
  ports:
    - "8080"
  build: .
  volumes:
    - ./:/gopath/src/github.com/victorcoder/dkron
  environment:
    - GODEBUG=netdns=go
  command: go run main.go agent -server -backend=etcd -backend-machine=etcd:4001 -join=dkron_seed:8946
